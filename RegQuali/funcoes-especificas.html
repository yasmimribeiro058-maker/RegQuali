<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Registro de Qualidade</title>


    <link rel="stylesheet" href="estilo-cabecalho.css">
    <link rel="stylesheet" href="estilo.rodape.css">
    <link rel="stylesheet" href="funcoes-execucao.css">
</head>


<body>
<header class="cabecalho">
        <div class="logo-area">
            <h1>RegQuali</h1>

        </div>
        <nav class="menu-principal">
            <ul>
                <li><a href="sobre-nos.html">Sobre Nós</a></li>
                <li><a href="registro-qualidade.html">Funções de Identificação</a></li>
                <li><a href="funcoes-execucao.html">Função de Execução</a></li>
                <li><a href="funcoes-especificas.html">Funções Específicas</a></li>
            </ul>
        </nav>
    </header>

<form id="form">
    <div class="login">
        <div class="caixa">
            <h1>Funções Específicas</h1>

                <div class="colunas">
                <div class="login-grupo">
                    <label for="descricao">Descrição Detalhada da Falha:</label>
                    <input type="text" name="descricao" id="descricao" required>
                </div>


                <div class="login-grupo">
                    <label for="disposicao">Disposição do Material:</label>
                    <input type="text" name="disposicao" id="disposicao" required>
                </div>
                </div>


                <div class="colunas">
                <div class="login-grupo">
                    <label for="acaoimediata">Ação Imediata/Contenção:</label>
                    <input type="text" name="acaoimediata" id="acaoimediata" required>
                </div>


                <div class="login-grupo">
                    <label for="causa">Causa Raiz:</label>
                    <input type="text" name="causa" id="causa" required>
                </div>
                </div>


                <div class="colunas">
                <div class="login-grupo">
                    <label for="acaocorretiva">Ação Corretiva:</label>
                    <input type="text" name="acaocorretiva" id="acaocorretiva" required>
                </div>


                <div class="login-grupo">
                    <label for="verificacao">Verificação da Eficácia:</label>
                    <input type="text" name="verificacao" id="verificacao" required>
                </div>
                </div>


                  <div class="login-grupo">
                    <label for="responsavel">Responsável pela Ação Corretiva:</label>
                    <input type="text" name="responsavel" id="responsavel" required>
                </div>


   
                <div id="mensagem" style="margin-bottom: 15px; color: rgb(128, 255, 128); font-weight: bold;"></div>

                    <button type="submit" class="login-botao">Enviar</button>
                </form>
                <h2 style="margin-left: 40px; margin-top: 30px; color: white;">Registros Salvos:</h2>
                <div id="lista" style="margin-left: 40px; margin-bottom: 50px;"></div>


                <p id="mensagem"></p>

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>  
<script>
    //Comunicação com o firebase e o JS
    const firebaseConfig = {
  apiKey: "AIzaSyA9fA6bFMAchycG0yfMRs0K1LaJVhgKDqA",
  authDomain: "formulario-reg-banco.firebaseapp.com",
  databaseURL: "https://formulario-reg-banco-default-rtdb.firebaseio.com",
  projectId: "formulario-reg-banco",
  storageBucket: "formulario-reg-banco.firebasestorage.app",
  messagingSenderId: "732815595704",
  appId: "1:732815595704:web:68d0daa828453aac257c4d"
};
//Inicializando o Firebase
firebase.initializeApp(firebaseConfig);
const database = firebase.database();


//Envia dados ao Realtime Database
document.getElementById('form').addEventListener('submit',function(e) {
    e.preventDefault(); //Impede a reinicialização automatica do formulário
    //Guarda o valor de nome e e-mail do HTML nas variaveis JS
    const descricao = document.getElementById('descricao').value;
    const disposicao = document.getElementById('disposicao').value;
    const acaoimediata = document.getElementById('acaoimediata').value;
    const causa = document.getElementById('causa').value;
    const acaocorretiva= document.getElementById('acaocorretiva').value;
    const verificacao = document.getElementById('verificacao').value;
    const responsavel = document.getElementById('responsavel').value;



    //Avisa o firebase que os dados serão guardados dentro dele
    database.ref('usuarios').push({
        descricao:descricao,
        disposicao:disposicao,
        acaoimediata:acaoimediata,
        causa:causa,
        acaocorretiva:acaocorretiva,
        verificacao:verificacao,
        responsavel:responsavel
     
    })
    .then(() => {
        document.getElementById('mensagem').innerText = 'Dados enviados com sucesso!';
        //Entra em outra pagina
 
    })
    .catch(error => {
        document.getElementById('mensagem').innerText = 'Erro:' +error.message;
    });
});
// ------------------ EXIBIR DADOS NA MESMA TELA ------------------

const lista = document.getElementById("lista");

database.ref("usuarios").on("value", function(snapshot) {
    lista.innerHTML = ""; // limpa a lista antes de atualizar

    snapshot.forEach(function(childSnapshot) {
        const dado = childSnapshot.val();

        lista.innerHTML += `
            <div style="
                background:#f5f5f5;
                padding:15px;
                margin-bottom:15px;
                border-radius:8px;
                width:90%;
                max-width:650px;
                box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            ">
                <p><strong>Descrição da Falha:</strong> ${dado.descricao}</p>
                <p><strong>Disposição do Material:</strong> ${dado.disposicao}</p>
                <p><strong>Ação Imediata / Contenção:</strong> ${dado.acaoimediata}</p>
                <p><strong>Causa Raiz:</strong> ${dado.causa}</p>
                <p><strong>Ação Corretiva:</strong> ${dado.acaocorretiva}</p>
                <p><strong>Verificação da Eficácia:</strong> ${dado.verificacao}</p>
                <p><strong>Responsável:</strong> ${dado.responsavel}</p>
            </div>
        `;
    });
});

</script>

        </div>
    </div>
<footer class="footer">
        <div class="footer-container">


            <div class="footer-col">
                <h2 class="logo">RegQuali</h2>
                <p><strong>Endereço:</strong></p>
                <p>Rua Guatemala 19<br>
                <p class="wh-title"><strong> WhatsApp Vendas:</strong></p>
                <a href="#">(055) 113047-7300</a></p>
                <p class="wh-title"><strong> WhatsApp Suporte:</strong></p>
                <a href="#">(055) 113047-7322</a></p>
            </div>


            <div class="footer-col">
                <h3>Nossas soluções</h3>
                <a href="#">Gestão de Documentos</a>
                <a href="#">Gestão de Não Conformidades</a>
                <a href="#">Gestão de Riscos</a>
                <a href="#">Gestão de Fornecedores</a>
            </div>


            <div class="footer-col">
                <h3>Indústrias</h3>
                <a href="#">Indústria Geral</a>
                <a href="#">Logística</a>
                <a href="#">Engenharia e Construção Civil</a>
                <a href="#">Demais setores</a>
            </div>


            <div class="footer-col">
                <h3>Sobre nós</h3>
                <a href="sobrenos.html">Cases de Sucesso</a>
                <a href="sobrenos.html">Sobre nós</a>
                <a href="#">Contato</a>
            </div>


            <div class="footer-col">
                <h3>Conteúdos</h3>
                <a href="#">Materiais gratuitos</a>
                <a href="#">RegQuali Explica</a>
                <a href="#">Diagnóstico SGQ</a>
                <a href="#">Newsletter</a>
            </div>
        </div>
    </footer>
   
    </body>
</body>
</html>
